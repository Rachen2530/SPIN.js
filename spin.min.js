var SPIN=function(a){a&&this.set(a)};SPIN.prototype.set=function(a){/^([0-9]{6}|[0-9]{8})[\-\+]{0,1}[0-9]{4}$/.test(a)?(this.input=a,a=new Date,this.nowY=a.getFullYear(),this.nowM=a.getMonth()+1,this.nowD=a.getDate(),this.num=this.input.replace(/\D/g,""),10===this.num.length&&this.addCentury(),this.valid()||console.warn(this.input+" is not a valid identity number")):console.error("Identity number must contain 10 or 12 digits, allowed characters are 0-9, '+' and '-'.")};
SPIN.prototype.addCentury=function(){var a=parseInt(this.nowY.toString().substr(0,2),10),c=parseInt(this.nowY.toString().substr(2,2),10),b=parseInt(this.num.substr(0,2),10),e=parseInt(this.num.substr(2,2),10),d=parseInt(this.num.substr(4,2),10);a=a-(b===c&&e>=this.nowM&&d>this.nowD||b>c?1:0)-("+"===this.input.substr(-5,1)?1:0);this.num=(10>a?"0":"")+a+this.num};SPIN.prototype.id=function(){return this.valid()?this.num:!1};
SPIN.prototype.gender=function(){return this.valid()?0===this.num.substr(-2,1)%2?"FEMALE":"MALE":!1};SPIN.prototype.age=function(){var a=parseInt(this.num.substr(0,4),10),c=parseInt(this.num.substr(4,2),10),b=parseInt(this.num.substr(6,2),10);b-=61<=b?60:0;a=this.nowY===a&&c<=this.nowM&&b<=this.nowD?0:this.nowY===a?-1:a>this.nowY?this.nowY-a:this.nowY-a-(this.nowY>=a&&c>=this.nowM&&b>this.nowD?1:0);return this.valid()?a:!1};
SPIN.prototype.type=function(){return this.valid()?61<=parseInt(this.num.substr(6,2),10)?"SAN":"PEN":!1};
SPIN.prototype.valid=function(){if(!/^([0-9]{4}((0[13578]|1[02])([06][1-9]|[1278][0-9]|[39][0-1])|(0[469]|11)([06][1-9]|[1278][0-9]|[39]0)|02([06][1-9]|[17][0-9]|[28][0-8]))|([0-9]{2}([02468][48]|[13579][26]|[2468]0)|([02468][048]|[13579][26])00)02[28]9)(00[1-9]|0[1-9][0-9]|[1-9][0-9]{2})[0-9]$/.test(this.num))return!1;for(var a=this.num.substr(-10),c=[0,2,4,6,8,1,3,5,7,9],b=10,e=1,d=0,f;b;)f=parseInt(a.charAt(--b),10),d+=(e^=1)?c[f]:f;return d&&0===d%10};
